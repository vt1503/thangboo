{"remainingRequest":"/Users/tule/Code/winbo.trade/node_modules/thread-loader/dist/cjs.js!/Users/tule/Code/winbo.trade/node_modules/babel-loader/lib/index.js!/Users/tule/Code/winbo.trade/node_modules/eslint-loader/index.js??ref--13-0!/Users/tule/Code/winbo.trade/src/auth/authService.js","dependencies":[{"path":"/Users/tule/Code/winbo.trade/src/auth/authService.js","mtime":1621953988000},{"path":"/Users/tule/Code/winbo.trade/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/tule/Code/winbo.trade/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/tule/Code/winbo.trade/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/tule/Code/winbo.trade/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.reflect.construct\";\nimport _classCallCheck from \"/Users/tule/Code/winbo.trade/node_modules/@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/tule/Code/winbo.trade/node_modules/@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _assertThisInitialized from \"/Users/tule/Code/winbo.trade/node_modules/@babel/runtime-corejs2/helpers/esm/assertThisInitialized\";\nimport _inherits from \"/Users/tule/Code/winbo.trade/node_modules/@babel/runtime-corejs2/helpers/esm/inherits\";\nimport _possibleConstructorReturn from \"/Users/tule/Code/winbo.trade/node_modules/@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/tule/Code/winbo.trade/node_modules/@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _defineProperty from \"/Users/tule/Code/winbo.trade/node_modules/@babel/runtime-corejs2/helpers/esm/defineProperty\";\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nimport auth0 from 'auth0-js';\nimport EventEmitter from 'events';\nimport authConfig from '@/../auth_config.json';\nimport store from \"@/store/store.js\"; // 'loggedIn' is used in other parts of application. So, Don't forget to change there also\n\nvar localStorageKey = 'loggedIn';\nvar tokenExpiryKey = 'tokenExpiry';\nvar loginEvent = 'loginEvent';\nvar webAuth = new auth0.WebAuth({\n  domain: authConfig.domain,\n  redirectUri: window.location.origin + process.env.BASE_URL + \"callback\",\n  clientID: authConfig.clientId,\n  responseType: 'id_token',\n  scope: 'openid profile email'\n});\n\nvar AuthService = /*#__PURE__*/function (_EventEmitter) {\n  _inherits(AuthService, _EventEmitter);\n\n  var _super = _createSuper(AuthService);\n\n  function AuthService() {\n    var _this;\n\n    _classCallCheck(this, AuthService);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _super.call.apply(_super, [this].concat(args));\n\n    _defineProperty(_assertThisInitialized(_this), \"idToken\", null);\n\n    _defineProperty(_assertThisInitialized(_this), \"profile\", null);\n\n    _defineProperty(_assertThisInitialized(_this), \"tokenExpiry\", null);\n\n    return _this;\n  }\n\n  _createClass(AuthService, [{\n    key: \"login\",\n    value: // Starts the user login flow\n    function login(customState) {// webAuth.authorize({\n      //     appState: customState\n      // });\n    } // Handles the callback request from Auth0\n\n  }, {\n    key: \"handleAuthentication\",\n    value: function handleAuthentication() {// return new Promise((resolve, reject) => {\n      //     webAuth.parseHash((err, authResult) => {\n      //         if (err) {\n      //             alert(err.error + '. Detailed error can be found in console.');\n      //             reject(err);\n      //         } else {\n      //             this.localLogin(authResult);\n      //             resolve(authResult.idToken);\n      //         }\n      //     });\n      // });\n    }\n  }, {\n    key: \"localLogin\",\n    value: function localLogin(authResult) {// this.idToken = authResult.idToken;\n      // this.profile = authResult.idTokenPayload;\n      // // Convert the JWT expiry time from seconds to milliseconds\n      // this.tokenExpiry = new Date(this.profile.exp * 1000);\n      // localStorage.setItem(tokenExpiryKey, this.tokenExpiry);\n      // localStorage.setItem(localStorageKey, 'true');\n      // store.commit(\"UPDATE_USER_INFO\", {\n      //     displayName: this.profile.name,\n      //     email: this.profile.email,\n      //     photoURL: this.profile.picture,\n      //     providerId: this.profile.sub.substr(0, this.profile.sub.indexOf('|')),\n      //     uid: this.profile.sub\n      // })\n      // this.emit(loginEvent, {\n      //     loggedIn: true,\n      //     profile: authResult.idTokenPayload,\n      //     state: authResult.appState || {}\n      // });\n    }\n  }, {\n    key: \"renewTokens\",\n    value: function renewTokens() {// // reject can be used as parameter in promise for using reject\n      // return new Promise((resolve) => {\n      //     if (localStorage.getItem(localStorageKey) !== \"true\") {\n      //         // return reject(\"Not logged in\");\n      //     }\n      //     webAuth.checkSession({}, (err, authResult) => {\n      //         if (err) {\n      //             // reject(err);\n      //         } else {\n      //             this.localLogin(authResult);\n      //             resolve(authResult);\n      //         }\n      //     });\n      // });\n    }\n  }, {\n    key: \"logOut\",\n    value: function logOut() {\n      localStorage.removeItem(localStorageKey);\n      localStorage.removeItem(tokenExpiryKey);\n      localStorage.removeItem('userInfo');\n      this.idToken = null;\n      this.tokenExpiry = null;\n      this.profile = null;\n      webAuth.logout({\n        returnTo: window.location.origin + process.env.BASE_URL\n      });\n      this.emit(loginEvent, {\n        loggedIn: false\n      });\n    }\n  }, {\n    key: \"isAuthenticated\",\n    value: function isAuthenticated() {// return (\n      //     new Date(Date.now()) < new Date(localStorage.getItem(tokenExpiryKey)) &&\n      //     localStorage.getItem(localStorageKey) === 'true'\n      // );\n    }\n  }]);\n\n  return AuthService;\n}(EventEmitter);\n\nexport default new AuthService();",null]}