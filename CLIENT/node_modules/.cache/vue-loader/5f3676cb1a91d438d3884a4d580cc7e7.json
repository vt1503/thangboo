{"remainingRequest":"/Users/tule/Code/winbo.trade/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/tule/Code/winbo.trade/src/pages/trade/slidebar/2FAGoogle.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/tule/Code/winbo.trade/src/pages/trade/slidebar/2FAGoogle.vue","mtime":1649894645188},{"path":"/Users/tule/Code/winbo.trade/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/tule/Code/winbo.trade/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/tule/Code/winbo.trade/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/tule/Code/winbo.trade/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/tule/Code/winbo.trade/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\r\n\r\nimport AuthenticationService from '@/services/AuthenticationService'\r\nimport getData from '@/pages/trade/navbar/components/data.json'\r\n\r\n\r\nexport default {\r\n    data() {\r\n      return {\r\n          isActive2FA: false,\r\n          disSendCode: false,\r\n          MSLuu: '',\r\n          linkBase64Img: '',\r\n          code2FA: '',\r\n          codeActive: '',\r\n          passwordSend: '',\r\n          ssDownSend: 'Gửi mã',\r\n          backgroundLoading:'primary',\r\n          colorLoading: '#fff'\r\n      }  \r\n    },\r\n    methods: {\r\n\r\n        copyMSL(){\r\n            const thisIns = this;\r\n\r\n            this.$copyText(this.MSLuu).then(function() {\r\n                thisIns.$vs.notify({\r\n                    text: 'Đã sao chép vào bộ nhớ',\r\n                    color: 'success',\r\n                    iconPack: 'feather',\r\n                    position: 'top-right',\r\n                    icon: 'icon-check-circle'\r\n                })\r\n            }, function() {\r\n                thisIns.$vs.notify({\r\n                    text: 'Lỗi sao chép',\r\n                    color: 'danger',\r\n                    iconPack: 'feather',\r\n                    position: 'top-right',\r\n                    icon: 'icon-alert-circle'\r\n                })\r\n            })\r\n        },\r\n\r\n        sendCodeSecure(){\r\n            this.disSendCode = true;\r\n\r\n            this.$vs.loading({\r\n                //background: this.backgroundLoading,\r\n                color: this.colorLoading,\r\n                container: \"#button-with-loading\",\r\n                scale: 0.45\r\n            })\r\n            let giay = 60;\r\n            let countD = setInterval(() => {\r\n                this.ssDownSend = giay + 's'\r\n                if(giay == 0){\r\n                    giay = 60;\r\n                    this.disSendCode = false\r\n                    this.$vs.loading.close(\"#button-with-loading > .con-vs-loading\")\r\n                    this.ssDownSend = 'Gửi mã'\r\n                    clearInterval(countD)\r\n                }\r\n                giay--;\r\n            }, 1000);\r\n            this.Send2FACode();\r\n            return;\r\n        },\r\n\r\n        Send2FACode(){\r\n            AuthenticationService.sendGG2FA();\r\n            return this.$vs.notify({\r\n                text: 'Đã gửi mã xác nhận.',\r\n                iconPack: 'feather',\r\n                icon: 'icon-check',\r\n                position:'top-right',\r\n                color: 'success'\r\n            });\r\n        },\r\n\r\n        clickVerify(){\r\n            let secret = this.MSLuu;\r\n\r\n            if(secret == '' || this.code2FA == '' || this.codeActive == '' || this.passwordSend == ''){\r\n                return this.$vs.notify({\r\n                        text: 'Các trường không được rỗng.',\r\n                        iconPack: 'feather',\r\n                        icon: 'icon-check',\r\n                        position:'top-right',\r\n                        color: 'danger'\r\n                    });\r\n            }\r\n\r\n            let obj = {\r\n                s : secret,\r\n                t : this.code2FA,\r\n                c : this.codeActive,\r\n                p : this.passwordSend\r\n            }\r\n            AuthenticationService.activeGG2FA(obj)\r\n            .then((res) => {\r\n                if(res.data.success == 1){\r\n\r\n                    this.code2FA = '';\r\n                    this.codeActive = '';\r\n                    this.passwordSend = '';\r\n                    getData.c2fa = 1;\r\n                    this.isActive2FA = true;\r\n\r\n\r\n                    return this.$vs.notify({\r\n                        text: 'Bật Google 2FA thành công.',\r\n                        iconPack: 'feather',\r\n                        icon: 'icon-check',\r\n                        position:'top-right',\r\n                        color: 'success'\r\n                    });\r\n                }else if(res.data.success == 0){\r\n                    return this.$vs.notify({\r\n                        text: 'Sai mật khẩu hoặc mã xác nhận.',\r\n                        iconPack: 'feather',\r\n                        icon: 'icon-check',\r\n                        position:'top-right',\r\n                        color: 'danger'\r\n                    });\r\n                }else if(res.data.success == 2){\r\n                    return this.$vs.notify({\r\n                        text: 'Mã 2FA không chính xác.',\r\n                        iconPack: 'feather',\r\n                        icon: 'icon-check',\r\n                        position:'top-right',\r\n                        color: 'danger'\r\n                    });\r\n                }else if(res.data.success == 4){\r\n                    localStorage.removeItem('INFO')\r\n                    localStorage.removeItem('tokenUser')\r\n                    window.location.href = window.location.origin + '/login'\r\n                }\r\n            })\r\n\r\n        },\r\n\r\n        clickUnVerify(){\r\n\r\n            if(this.code2FA == '' || this.codeActive == '' || this.passwordSend == ''){\r\n                return this.$vs.notify({\r\n                        text: 'Các trường không được rỗng.',\r\n                        iconPack: 'feather',\r\n                        icon: 'icon-check',\r\n                        position:'top-right',\r\n                        color: 'danger'\r\n                    });\r\n            }\r\n\r\n            let obj = {\r\n                t : this.code2FA,\r\n                c : this.codeActive,\r\n                p : this.passwordSend\r\n            }\r\n\r\n            AuthenticationService.unActiveGG2FA(obj)\r\n            .then((res) => {\r\n                if(res.data.success == 1){\r\n\r\n                    this.code2FA = ''\r\n                    this.codeActive = ''\r\n                    this.passwordSend = ''\r\n                    getData.c2fa = 0\r\n                    this.isActive2FA = false\r\n                    //khởi tạo lại 2FA\r\n                    this.createQRCode2FA();\r\n\r\n                    return this.$vs.notify({\r\n                        text: 'Tắt Google 2FA thành công.',\r\n                        iconPack: 'feather',\r\n                        icon: 'icon-check',\r\n                        position:'top-right',\r\n                        color: 'success'\r\n                    });\r\n                }else if(res.data.success == 0){\r\n                    return this.$vs.notify({\r\n                        text: 'Sai mật khẩu hoặc mã xác nhận.',\r\n                        iconPack: 'feather',\r\n                        icon: 'icon-check',\r\n                        position:'top-right',\r\n                        color: 'danger'\r\n                    });\r\n                }else if(res.data.success == 2){\r\n                    return this.$vs.notify({\r\n                        text: 'Mã 2FA không chính xác.',\r\n                        iconPack: 'feather',\r\n                        icon: 'icon-check',\r\n                        position:'top-right',\r\n                        color: 'danger'\r\n                    });\r\n                }else if(res.data.success == 4){\r\n                    localStorage.removeItem('INFO')\r\n                    localStorage.removeItem('tokenUser')\r\n                    window.location.href = window.location.origin + '/login'\r\n                }\r\n            })\r\n        },\r\n\r\n        createQRCode2FA(){\r\n            AuthenticationService.createGG2FA()\r\n            .then((res) => {\r\n                if(res.data.success){\r\n                    this.MSLuu = res.data.s\r\n                    this.linkBase64Img = res.data.qr\r\n                }\r\n                if(res.data.success == 4){\r\n                    localStorage.removeItem('INFO')\r\n                    localStorage.removeItem('tokenUser')\r\n                    window.location.href = window.location.origin + '/login'\r\n                }\r\n            })\r\n        },\r\n    },\r\n    created() {\r\n\r\n        if(!getData.c2fa){\r\n            this.createQRCode2FA()\r\n        }else{\r\n            this.isActive2FA = true\r\n        }\r\n    },\r\n}\r\n",null]}